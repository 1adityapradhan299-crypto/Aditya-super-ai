<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super AI üöÄ</title>
    <style>
        body { font-family: 'Poppins', sans-serif; background: #0b0e14; color: #00ff41; display: flex; align-items: center; justify-content: center; min-height: 100vh; margin: 0; }
        .app-container { width: 95%; max-width: 450px; height: 90vh; background: #1a1f26; border-radius: 25px; display: flex; flex-direction: column; overflow: hidden; box-shadow: 0 10px 40px rgba(0,255,65,0.3); border: 1px solid #00ff41; }
        .header { background: #252a34; padding: 15px; text-align: center; font-weight: bold; font-size: 1.4rem; border-bottom: 2px solid #00ff41; color: #00ff41; text-shadow: 0 0 10px #00ff41; }
        #chat-box { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 12px; background: #0b0e14; }
        .msg { padding: 12px 16px; border-radius: 18px; max-width: 85%; line-height: 1.4; font-size: 0.95rem; }
        .user { background: #00ff41; color: #000; align-self: flex-end; font-weight: bold; box-shadow: 0 0 10px #00ff4155; }
        .ai { background: #252a34; color: #00ff41; align-self: flex-start; border: 1px solid #00ff4144; }
        .input-area { padding: 15px; background: #1a1f26; display: flex; flex-direction: column; gap: 10px; border-top: 1px solid #333; }
        .controls { display: flex; gap: 8px; }
        input { flex: 1; background: #0b0e14; border: 1px solid #00ff41; padding: 12px; border-radius: 12px; color: #00ff41; outline: none; }
        button { background: #00ff41; color: #000; border: none; padding: 10px 15px; border-radius: 12px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        button:active { transform: scale(0.95); }
        .cam-btn { background: #222; color: #00ff41; border: 1px solid #00ff41; }
        .preview-img { width: 70px; height: 70px; object-fit: cover; border-radius: 10px; border: 2px solid #00ff41; margin-bottom: 5px; animation: glow 1.5s infinite alternate; }
        @keyframes glow { from { box-shadow: 0 0 5px #00ff41; } to { box-shadow: 0 0 15px #00ff41; } }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="header">SUPER AI ü§ñ</div>
        <div id="chat-box">
            <div class="msg ai">Aur Aditya bhai, kaise ho? Main Super AI hoon. Kuch pucho ya camera se photo dikhao!</div>
        </div>
        <div class="input-area">
            <div id="img-preview-box"></div>
            <div class="controls">
                <input type="text" id="userInput" placeholder="Super AI se baat karein...">
                <button onclick="askAI()">SEND</button>
            </div>
            <div class="controls">
                <button class="cam-btn" onclick="document.getElementById('fileInput').click()">üìÅ Gallery</button>
                <button class="cam-btn" onclick="document.getElementById('fileInput').setAttribute('capture','environment'); document.getElementById('fileInput').click()">üì∑ Camera</button>
                <input type="file" id="fileInput" style="display:none" accept="image/*" onchange="showPreview()">
            </div>
        </div>
    </div>
    <script>
        let base64Img = "";
        function showPreview() {
            const file = document.getElementById('fileInput').files[0];
            const reader = new FileReader();
            reader.onloadend = () => {
                base64Img = reader.result;
                document.getElementById('img-preview-box').innerHTML = `<img src="${base64Img}" class="preview-img">`;
            }
            if(file) reader.readAsDataURL(file);
        }

        async function askAI() {
            const input = document.getElementById('userInput');
            const box = document.getElementById('chat-box');
            if(!input.value.trim() && !base64Img) return;

            const userText = input.value;
            box.innerHTML += `<div class="msg user">${userText}</div>`;
            input.value = '';
            const currentImg = base64Img;
            base64Img = "";
            document.getElementById('img-preview-box').innerHTML = "";
            box.scrollTop = box.scrollHeight;

            try {
                const res = await fetch('/api/chat', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ 
                        prompt: "Aapka naam Super AI hai. Aapko Aditya ne banaya hai. Friendly Hinglish dost ki tarah jawab do: " + userText, 
                        image: currentImg 
                    })
                });
                
                const data = await res.json();
                if (data.reply) {
                    box.innerHTML += `<div class="msg ai">${data.reply}</div>`;
                    const voice = new SpeechSynthesisUtterance(data.reply);
                    voice.lang = 'hi-IN';
                    window.speechSynthesis.speak(voice);
                } else {
                    throw new Error();
                }
            } catch (err) {
                box.innerHTML += `<div class="msg ai">Bhai, thoda server load le raha hai, 1 min baad fir se pucho!</div>`;
            }
            box.scrollTop = box.scrollHeight;
        }
    </script>
</body>
</html>
